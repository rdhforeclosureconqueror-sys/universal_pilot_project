<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin / Dev Console — Internal Use Only</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <header>
      <h1>Admin / Dev Console — Internal Use Only</h1>
      <p class="hint"><a href="/#/">Return to Universal Pilot CRM</a></p>
      <p>
        Frontend aligned to backend models, enums, and workflows. Actions call live
        API endpoints; disabled states reflect backend gating rules.
      </p>
      <label class="field">
        <span>API Base URL</span>
        <input id="api-base" type="text" value="" placeholder="https://api.yourdomain.com" />
        <small>Leave blank to use relative paths.</small>
      </label>
    </header>

    <main>
      <section>
        <h2>Case Lifecycle</h2>
        <div class="grid">
          <div class="card">
            <h3>Case Model Fields</h3>
            <div class="schema-list" id="case-schema"></div>
          </div>
          <div class="card">
            <h3>Current Statuses (CaseStatus enum)</h3>
            <ul id="case-status-list"></ul>
          </div>
          <div class="card">
            <h3>Create Case</h3>
            <form id="case-create-form">
              <label class="field">
                <span>Program Key</span>
                <input type="text" name="program_key" required />
              </label>
              <label class="field">
                <span>Created By (UUID)</span>
                <input type="text" name="created_by" placeholder="UUID" required />
              </label>
              <label class="field">
                <span>Meta (JSON)</span>
                <textarea name="meta" placeholder='{"custom_field": "value"}'></textarea>
                <small>Custom fields must be allowed by the active policy.</small>
              </label>
              <button type="submit" id="case-create-submit" disabled>Create Case</button>
              <p class="hint">Case status is derived from policy review requirements.</p>
            </form>
            <pre class="response" id="case-create-response"></pre>
          </div>
        </div>
      </section>

      <section>
        <h2>Document Upload & Viewing</h2>
        <div class="grid">
          <div class="card">
            <h3>Upload Document</h3>
            <form id="document-upload-form">
              <label class="field">
                <span>Case ID (UUID)</span>
                <input type="text" name="case_id" required />
              </label>
              <label class="field">
                <span>Document Type</span>
                <select name="doc_type" id="doc-type-select" required></select>
              </label>
              <label class="field" id="evidence-type-field">
                <span>Evidence Type (required for doc_type = other)</span>
                <input type="text" name="evidence_type" />
              </label>
              <label class="field" id="document-meta-field">
                <span>Meta (JSON)</span>
                <textarea name="meta" placeholder='{"evidence_type": "custom"}'></textarea>
                <small>Only used for doc_type = other.</small>
              </label>
              <label class="field">
                <span>File</span>
                <input type="file" name="file" required />
              </label>
              <button type="submit" id="document-upload-submit" disabled>Upload Document</button>
            </form>
            <pre class="response" id="document-upload-response"></pre>
          </div>
          <div class="card">
            <h3>Get Document</h3>
            <form id="document-get-form">
              <label class="field">
                <span>Document ID (UUID)</span>
                <input type="text" name="doc_id" required />
              </label>
              <button type="submit" id="document-get-submit" disabled>Fetch Document</button>
            </form>
            <pre class="response" id="document-get-response"></pre>
          </div>
          <div class="card">
            <h3>List Case Documents</h3>
            <form id="document-list-form">
              <label class="field">
                <span>Case ID (UUID)</span>
                <input type="text" name="case_id" required />
              </label>
              <button type="submit" id="document-list-submit" disabled>List Documents</button>
            </form>
            <pre class="response" id="document-list-response"></pre>
          </div>
        </div>
      </section>

      <section>
        <h2>Auction CSV Import (Admin Only)</h2>
        <div class="grid">
          <div class="card">
            <h3>Upload Auction Import (CSV or PDF)</h3>
            <form id="auction-import-form">
              <label class="field">
                <span>CSV or PDF File (.csv, .pdf)</span>
                <input type="file" name="auction_csv" accept=".csv,.pdf" required />
              </label>
              <button type="submit" id="auction-import-submit" disabled>Import Auction File</button>
            </form>
            <pre class="response" id="auction-import-response"></pre>
          </div>
          <div class="card">
            <h3>Recent Auction Imports</h3>
            <p class="hint">Uploaded PDFs are stored and can be downloaded here.</p>
            <table class="data-table" id="auction-import-table">
              <thead>
                <tr>
                  <th>Filename</th>
                  <th>Status</th>
                  <th>Records</th>
                  <th>Uploaded</th>
                  <th>Download</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
            <p class="hint" id="auction-import-empty"></p>
          </div>
        </div>
      </section>

      <section>
        <h2>Consent Management</h2>
        <div class="grid">
          <div class="card">
            <h3>Grant Consent</h3>
            <form id="consent-grant-form">
              <label class="field">
                <span>Case ID (UUID)</span>
                <input type="text" name="case_id" required />
              </label>
              <label class="field">
                <span>Scope (comma-separated)</span>
                <input type="text" name="scope" placeholder="referral, document_share" required />
              </label>
              <button type="submit" id="consent-grant-submit" disabled>Grant Consent</button>
            </form>
            <pre class="response" id="consent-grant-response"></pre>
          </div>
          <div class="card">
            <h3>Revoke Consent</h3>
            <form id="consent-revoke-form">
              <label class="field">
                <span>Case ID (UUID)</span>
                <input type="text" name="case_id" required />
              </label>
              <button type="submit" id="consent-revoke-submit" disabled>Revoke Consent</button>
            </form>
            <pre class="response" id="consent-revoke-response"></pre>
          </div>
        </div>
      </section>

      <section>
        <h2>Task Checks</h2>
        <div class="card">
          <p>Task checks are evaluated server-side. No direct UI actions are exposed.</p>
          <div class="schema-list" id="taskcheck-schema"></div>
        </div>
      </section>

      <section>
        <h2>Referrals</h2>
        <div class="grid">
          <div class="card">
            <h3>Queue Referral</h3>
            <form id="referral-queue-form">
              <label class="field">
                <span>Case ID (UUID)</span>
                <input type="text" name="case_id" required />
              </label>
              <label class="field">
                <span>Partner ID (UUID)</span>
                <input type="text" name="partner_id" required />
              </label>
              <button type="submit" id="referral-queue-submit" disabled>Queue Referral</button>
              <p class="hint">Requires active consent scope including <code>referral</code>.</p>
            </form>
            <pre class="response" id="referral-queue-response"></pre>
          </div>
          <div class="card">
            <h3>Referral Statuses (ReferralStatus enum)</h3>
            <ul id="referral-status-list"></ul>
          </div>
        </div>
      </section>

      <section>
        <h2>Certifications</h2>
        <div class="card">
          <p>Certifications are issued through training workflows.</p>
          <div class="schema-list" id="certification-schema"></div>
        </div>
      </section>

      <section>
        <h2>Training Quiz Attempts</h2>
        <div class="card">
          <form id="training-quiz-form">
            <label class="field">
              <span>Case ID (UUID)</span>
              <input type="text" name="case_id" required />
            </label>
            <label class="field">
              <span>Quiz Key</span>
              <input type="text" name="quiz_key" required />
            </label>
            <label class="field">
              <span>Answers (JSON)</span>
              <textarea name="answers" placeholder='{"Question?": "Answer"}' required></textarea>
            </label>
            <button type="submit" id="training-quiz-submit" disabled>Submit Quiz Attempt</button>
          </form>
          <pre class="response" id="training-quiz-response"></pre>
        </div>
      </section>

      <section>
        <h2>Audit Logs</h2>
        <div class="card">
          <p>Audit logs are append-only and generated by backend actions.</p>
          <div class="schema-list" id="audit-log-schema"></div>
        </div>
      </section>

      <section>
        <h2>AI Activity Logs</h2>
        <div class="grid">
          <div class="card">
            <h3>AI Dry Run</h3>
            <form id="ai-dryrun-form">
              <label class="field">
                <span>Case ID (UUID)</span>
                <input type="text" name="case_id" required />
              </label>
              <label class="field">
                <span>Prompt</span>
                <textarea name="prompt" required></textarea>
              </label>
              <label class="field">
                <span>Role</span>
                <select name="role" id="ai-role-select" required></select>
              </label>
              <label class="field">
                <span>Policy Rule ID</span>
                <input type="text" name="policy_rule_id" required />
              </label>
              <button type="submit" id="ai-dryrun-submit" disabled>Run AI Dry Run</button>
            </form>
            <pre class="response" id="ai-dryrun-response"></pre>
          </div>
          <div class="card">
            <h3>AI Activity Log Fields</h3>
            <div class="schema-list" id="ai-log-schema"></div>
          </div>
        </div>
      </section>
    </main>

    <script src="/config.js"></script>
    <script type="module" src="/static/app.js"></script>
  </body>
</html>
